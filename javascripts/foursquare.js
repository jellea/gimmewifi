(function(){this.venueli=$$({},'<li><span data-bind="name"/></li>',{"click span":function(){return console.log(this.model.get("content")),$("#venuelist").hide(),$$.document.append($$(venuemodal,{content:this.model.get("content")}))}}),this.venuemodal=$$({},'<div id="venuemodal" class="overlay"><span data-bind="content.name"/></div>',{"click span":function(){return console.log(this.model.get("content"))}}),this.foursquare={clientId:"21123S2W0VJYKFM0KDCDYMCUCQYZYLSHEROTKPNT1JY2SUFR",clientSecret:"DEYFJL2KBMXUUVC0WFAAAAMLDDNX2Q351N2ORRTCQI4B1MJ0",tipSearch:function(e){var t;return t=e.coords.latitude+","+e.coords.longitude,$.Marelle(foursquare.clientId).done(function(e){var n;return n={ll:t,client_id:foursquare.clientId,client_secret:foursquare.clientSecret,v:"20120927",query:"wifi"},$.Marelle.Tip.search(n).done(function(e){var t,n,r,i,s;i=e.response.tips,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(maps.createPointer(t));return s})})},addSpot:function(){var e,t;return $("#venuelist").show(),e=maps.latitude+","+maps.longitude,t={ll:e,client_id:foursquare.clientId,client_secret:foursquare.clientSecret,v:"20120927",limit:10},$.Marelle.Venue.search(t).done(function(e){var t,n,r,i,s,o;foursquare.venues=[],s=e.response.venues,o=[];for(r=0,i=s.length;r<i;r++)n=s[r],t=$$(venueli,{content:n,name:n.name}),o.push($$.document.append(t,"#venuelist ul"));return o})}},$(function(){return $("body").prepend('<div id="addspot">+</div>'),$("#addspot").click(foursquare.addSpot),$("#venuelist ul li").bind("click",function(){return console.log("bla")})})}).call(this);